{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _objectSpread from\"/var/www/turf2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/var/www/turf2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useCallback,useContext}from\"react\";import classnames from\"classnames\";import axios from\"axios\";import{BiCalendarWeek}from\"react-icons/bi\";import{toast}from\"react-toastify\";import styles from\"../css/Bookings.module.css\";import GroundImage from\"../images/ground.png\";import GroundImageSelected from\"../images/ground_selected.png\";import api from\"../config/api\";import headerWithoutToken from\"../config/headerWithoutToken\";import{Context}from\"../data/context\";import SlotItems from\"./SlotItems\";import{convertMinsToHrsMins,getMaxAllowedMonth}from\"../utils/TimeConverter\";import{Link}from\"react-router-dom\";import{filterData}from\"../utils/filterData\";var Bookings=function Bookings(){var _useContext=useContext(Context),setGroundData=_useContext.setGroundData,totalTime=_useContext.totalTime,bookDate=_useContext.bookDate,setBookDate=_useContext.setBookDate,setCartId=_useContext.setCartId,setPhoneNumber=_useContext.setPhoneNumber,setCartData=_useContext.setCartData;var _useState=useState(true),_useState2=_slicedToArray(_useState,2),isGroundSelected1=_useState2[0],setIsGroundSelected1=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isGroundSelected2=_useState4[0],setIsGroundSelected2=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isGroundSelected3=_useState6[0],setIsGroundSelected3=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),maxAllowedDate=_useState8[0],setMaxAllowedDate=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),startTime=_useState10[0],setStartTime=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),endTime=_useState12[0],setEndTime=_useState12[1];var handleFetchedData=useCallback(function(res,FetchgroundData){if(res.data.success){var _filterData=filterData(res.data.body),_filterData2=_slicedToArray(_filterData,1),sortedData=_filterData2[0];setCartData(sortedData);var selectedDateCart=sortedData[bookDate];var newData=FetchgroundData;if(selectedDateCart){if(selectedDateCart.turf01&&newData.turf01){selectedDateCart.turf01.forEach(function(item){newData.turf01.forEach(function(item2){if(\"\".concat(item.startTime,\"_g1_\").concat(item.date)===\"\".concat(item2.startTime,\"_g1_\").concat(item2.date)){item2.isSelected=true;}});});}if(selectedDateCart.turf02&&newData.turf02){selectedDateCart.turf02.forEach(function(item){newData.turf02.forEach(function(item2){if(\"\".concat(item.startTime,\"_g2_\").concat(item.date)===\"\".concat(item2.startTime,\"_g2_\").concat(item2.date)){item2.isSelected=true;}});});}if(selectedDateCart.turf03&&newData.turf03){selectedDateCart.turf03.forEach(function(item){newData.turf03.forEach(function(item2){if(\"\".concat(item.startTime,\"_g3_\").concat(item.date)===\"\".concat(item2.startTime,\"_g3_\").concat(item2.date)){item2.isSelected=true;}});});}}setGroundData(_objectSpread({},newData));}},[setCartData,bookDate,setGroundData]);var fetchCartData=useCallback(function(FetchgroundData){var data=JSON.parse(localStorage.getItem(\"turfUserDetails\"));var cartLocalId=localStorage.getItem(\"turfCart\");setCartId(function(){return cartLocalId?cartLocalId:null;});setPhoneNumber(function(){var _data$user;return(data===null||data===void 0?void 0:(_data$user=data.user)===null||_data$user===void 0?void 0:_data$user.phoneNumber)?data.user.phoneNumber:null;});// if (data === null && cartLocalId === null) {\n//   setCartId(null);\n// } else if (data === null && cartLocalId != null) {\n//   setCartId(cartLocalId);\n// } else {\n//   setPhoneNumber(data.user.phoneNumber);\n// }\nif(data===null){axios.get(api+\"user/cart?cartId=\"+cartLocalId,headerWithoutToken).then(function(res){handleFetchedData(res,FetchgroundData);}).catch(function(err){console.log(err);});}else{axios.get(api+\"user/cart?phoneNumber=\"+data.user.phoneNumber,headerWithoutToken).then(function(res){handleFetchedData(res,FetchgroundData);}).catch(function(err){console.log(err);});}},[handleFetchedData,setCartId,setPhoneNumber]);var getAllSlotsByDateTime=useCallback(function(){var groundList=[];if(isGroundSelected1){groundList.push(\"turf01\");}if(isGroundSelected2){groundList.push(\"turf02\");}if(isGroundSelected3){groundList.push(\"turf03\");}var postData={turfIds:[].concat(groundList),date:bookDate,openTime:\"2020-12-24T08:00:00.000Z\",closeTime:\"2020-12-24T16:00:10.000Z\",slotDuration:30};axios.post(api+\"user/get-all-slots-by-date\",postData,headerWithoutToken).then(function(res){var groundDataNew=res.data.body;console.log(\"Get All Slots by Date \",groundDataNew);if(groundDataNew){if(groundDataNew.turf01){groundDataNew.turf01.forEach(function(item){item.id=\"\".concat(item.startTime,\"_g1_\").concat(item.date);});}if(groundDataNew.turf02){groundDataNew.turf02.forEach(function(item){item.id=\"\".concat(item.startTime,\"_g2_\").concat(item.date);});}if(groundDataNew.turf03){groundDataNew.turf03.forEach(function(item){item.id=\"\".concat(item.startTime,\"_g3_\").concat(item.date);});}fetchCartData(groundDataNew);}else{toast.error(\"No Slots Found\");}}).catch(function(error){toast.error(error.message);console.log(error.message);});},[isGroundSelected1,isGroundSelected2,isGroundSelected3,bookDate,fetchCartData]);var setUserData=useCallback(function(){var turfcartId=localStorage.getItem(\"turfCart\");var data=JSON.parse(localStorage.getItem(\"turfUserDetails\"));setCartId(function(){return turfcartId?turfcartId:null;});setPhoneNumber(function(){var _data$user2,_data$user3;return(data===null||data===void 0?void 0:(_data$user2=data.user)===null||_data$user2===void 0?void 0:_data$user2.phoneNumber)?data===null||data===void 0?void 0:(_data$user3=data.user)===null||_data$user3===void 0?void 0:_data$user3.phoneNumber:null;});},[setCartId,setPhoneNumber]);useEffect(function(){getMaxAllowedMonth(setMaxAllowedDate);setUserData();getAllSlotsByDateTime();},[getAllSlotsByDateTime,setUserData]);return/*#__PURE__*/_jsx(\"div\",{className:classnames(\"container is-fluid\"),children:/*#__PURE__*/_jsxs(\"div\",{className:classnames(\"columns\",styles.columnsWrapper),children:[/*#__PURE__*/_jsxs(\"div\",{className:classnames(\"column box\",styles.addGroundBackground),children:[/*#__PURE__*/_jsx(\"figure\",{className:classnames(\"image\",styles.rotate1),onClick:function onClick(){setIsGroundSelected1(!isGroundSelected1);},children:isGroundSelected1?/*#__PURE__*/_jsx(\"img\",{src:GroundImageSelected,alt:\"Ground 1\",className:styles.GroundImage}):/*#__PURE__*/_jsx(\"img\",{src:GroundImage,alt:\"Ground 1\",className:styles.GroundImage})}),/*#__PURE__*/_jsx(\"figure\",{className:classnames(\"image\",styles.rotate),onClick:function onClick(){setIsGroundSelected2(!isGroundSelected2);},children:isGroundSelected2?/*#__PURE__*/_jsx(\"img\",{src:GroundImageSelected,alt:\"Ground 2\",className:styles.GroundImage}):/*#__PURE__*/_jsx(\"img\",{src:GroundImage,alt:\"Ground 2\",className:styles.GroundImage})}),/*#__PURE__*/_jsx(\"figure\",{className:classnames(\"image\",styles.rotate),onClick:function onClick(){setIsGroundSelected3(!isGroundSelected3);},children:isGroundSelected3?/*#__PURE__*/_jsx(\"img\",{src:GroundImageSelected,alt:\"Ground 3\",className:styles.GroundImage}):/*#__PURE__*/_jsx(\"img\",{src:GroundImage,alt:\"Ground 3\",className:styles.GroundImage})})]}),/*#__PURE__*/_jsxs(\"div\",{className:classnames(\"column box is-two-thirds\",styles.addMinHeight,styles.addBookingBackground),children:[/*#__PURE__*/_jsxs(\"div\",{className:classnames(styles.timeBarWrapper),children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\"},className:styles.dateWrapper,children:[/*#__PURE__*/_jsx(BiCalendarWeek,{size:40,color:\"#FFF\",className:\"mx-3\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"control has-icons-right\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"input\",type:\"date\",placeholder:\"Pick Date\",value:bookDate,min:new Date().toISOString().slice(0,10),max:maxAllowedDate,onChange:function onChange(event){setBookDate(event.target.value);}}),/*#__PURE__*/_jsx(\"span\",{className:\"icon is-small is-right\",children:/*#__PURE__*/_jsx(BiCalendarWeek,{color:\"#000\"})})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\"},children:[/*#__PURE__*/_jsx(BiCalendarWeek,{size:40,color:\"#FFF\",className:\"mx-3\"}),/*#__PURE__*/_jsx(\"div\",{className:\"control\",children:/*#__PURE__*/_jsx(\"input\",{className:\"input \",type:\"time\",placeholder:\"Pick Start Time\",value:startTime,onChange:function onChange(event){return setStartTime(event.target.value);}})}),/*#__PURE__*/_jsx(\"div\",{className:\"control\",children:/*#__PURE__*/_jsx(\"input\",{className:\"input ml-3\",type:\"time\",placeholder:\"Pick End Time\",value:endTime,onChange:function onChange(event){return setEndTime(event.target.value);}})})]})]}),/*#__PURE__*/_jsx(\"div\",{className:classnames(styles.slotsWrapper),children:/*#__PURE__*/_jsx(SlotItems,{})}),/*#__PURE__*/_jsx(\"div\",{className:classnames(styles.checkoutWrapper,\"my-3\"),children:/*#__PURE__*/_jsxs(\"div\",{className:styles.timeBarWrapper,children:[/*#__PURE__*/_jsx(\"div\",{style:{display:\"flex\"},className:(styles.dateWrapper,\"is-hidden-touch\"),children:/*#__PURE__*/_jsx(\"div\",{className:\"field\",children:/*#__PURE__*/_jsx(\"div\",{className:\"control\",children:/*#__PURE__*/_jsx(\"input\",{className:classnames(styles.hourcal,\"input is-size-4-mobile is-size-3\"),type:\"text\",placeholder:\"Total Hours\",readOnly:true,value:convertMinsToHrsMins(totalTime)})})})}),/*#__PURE__*/_jsx(Link,{to:\"/cart\",className:classnames(styles.checkoutbtn,\"button is-success is-light my-3 is-size-4-mobile is-size-3\"),children:\"Checkout\"})]})})]})]})});};export default Bookings;","map":{"version":3,"sources":["/var/www/turf2/src/components/Bookings.jsx"],"names":["React","useState","useEffect","useCallback","useContext","classnames","axios","BiCalendarWeek","toast","styles","GroundImage","GroundImageSelected","api","headerWithoutToken","Context","SlotItems","convertMinsToHrsMins","getMaxAllowedMonth","Link","filterData","Bookings","setGroundData","totalTime","bookDate","setBookDate","setCartId","setPhoneNumber","setCartData","isGroundSelected1","setIsGroundSelected1","isGroundSelected2","setIsGroundSelected2","isGroundSelected3","setIsGroundSelected3","maxAllowedDate","setMaxAllowedDate","startTime","setStartTime","endTime","setEndTime","handleFetchedData","res","FetchgroundData","data","success","body","sortedData","selectedDateCart","newData","turf01","forEach","item","item2","date","isSelected","turf02","turf03","fetchCartData","JSON","parse","localStorage","getItem","cartLocalId","user","phoneNumber","get","then","catch","err","console","log","getAllSlotsByDateTime","groundList","push","postData","turfIds","openTime","closeTime","slotDuration","post","groundDataNew","id","error","message","setUserData","turfcartId","columnsWrapper","addGroundBackground","rotate1","rotate","addMinHeight","addBookingBackground","timeBarWrapper","display","dateWrapper","Date","toISOString","slice","event","target","value","slotsWrapper","checkoutWrapper","hourcal","checkoutbtn"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useCallback, useContext } from \"react\";\nimport classnames from \"classnames\";\nimport axios from \"axios\";\nimport { BiCalendarWeek } from \"react-icons/bi\";\nimport { toast } from \"react-toastify\";\nimport styles from \"../css/Bookings.module.css\";\nimport GroundImage from \"../images/ground.png\";\nimport GroundImageSelected from \"../images/ground_selected.png\";\nimport api from \"../config/api\";\nimport headerWithoutToken from \"../config/headerWithoutToken\";\nimport { Context } from \"../data/context\";\nimport SlotItems from \"./SlotItems\";\nimport {\n  convertMinsToHrsMins,\n  getMaxAllowedMonth,\n} from \"../utils/TimeConverter\";\nimport { Link } from \"react-router-dom\";\nimport { filterData } from \"../utils/filterData\";\n\nconst Bookings = () => {\n  const {\n    setGroundData,\n    totalTime,\n    bookDate,\n    setBookDate,\n    setCartId,\n    setPhoneNumber,\n    setCartData,\n  } = useContext(Context);\n\n  const [isGroundSelected1, setIsGroundSelected1] = useState(true);\n  const [isGroundSelected2, setIsGroundSelected2] = useState(false);\n  const [isGroundSelected3, setIsGroundSelected3] = useState(false);\n  const [maxAllowedDate, setMaxAllowedDate] = useState(\"\");\n  const [startTime, setStartTime] = useState(\"\");\n  const [endTime, setEndTime] = useState(\"\");\n\n  const handleFetchedData = useCallback(\n    (res, FetchgroundData) => {\n      if (res.data.success) {\n        const [sortedData] = filterData(res.data.body);\n        setCartData(sortedData);\n        const selectedDateCart = sortedData[bookDate];\n\n        const newData = FetchgroundData;\n        if (selectedDateCart) {\n          if (selectedDateCart.turf01 && newData.turf01) {\n            selectedDateCart.turf01.forEach((item) => {\n              newData.turf01.forEach((item2) => {\n                if (\n                  `${item.startTime}_g1_${item.date}` ===\n                  `${item2.startTime}_g1_${item2.date}`\n                ) {\n                  item2.isSelected = true;\n                }\n              });\n            });\n          }\n\n          if (selectedDateCart.turf02 && newData.turf02) {\n            selectedDateCart.turf02.forEach((item) => {\n              newData.turf02.forEach((item2) => {\n                if (\n                  `${item.startTime}_g2_${item.date}` ===\n                  `${item2.startTime}_g2_${item2.date}`\n                ) {\n                  item2.isSelected = true;\n                }\n              });\n            });\n          }\n\n          if (selectedDateCart.turf03 && newData.turf03) {\n            selectedDateCart.turf03.forEach((item) => {\n              newData.turf03.forEach((item2) => {\n                if (\n                  `${item.startTime}_g3_${item.date}` ===\n                  `${item2.startTime}_g3_${item2.date}`\n                ) {\n                  item2.isSelected = true;\n                }\n              });\n            });\n          }\n        }\n\n        setGroundData({ ...newData });\n      }\n    },\n    [setCartData, bookDate, setGroundData]\n  );\n\n  const fetchCartData = useCallback(\n    (FetchgroundData) => {\n      const data = JSON.parse(localStorage.getItem(\"turfUserDetails\"));\n      const cartLocalId = localStorage.getItem(\"turfCart\");\n\n      setCartId(() => (cartLocalId ? cartLocalId : null));\n\n      setPhoneNumber(() =>\n        data?.user?.phoneNumber ? data.user.phoneNumber : null\n      );\n\n      // if (data === null && cartLocalId === null) {\n      //   setCartId(null);\n      // } else if (data === null && cartLocalId != null) {\n      //   setCartId(cartLocalId);\n      // } else {\n      //   setPhoneNumber(data.user.phoneNumber);\n      // }\n\n      if (data === null) {\n        axios\n          .get(api + \"user/cart?cartId=\" + cartLocalId, headerWithoutToken)\n          .then((res) => {\n            handleFetchedData(res, FetchgroundData);\n          })\n          .catch((err) => {\n            console.log(err);\n          });\n      } else {\n        axios\n          .get(\n            api + \"user/cart?phoneNumber=\" + data.user.phoneNumber,\n            headerWithoutToken\n          )\n          .then((res) => {\n            handleFetchedData(res, FetchgroundData);\n          })\n          .catch((err) => {\n            console.log(err);\n          });\n      }\n    },\n    [handleFetchedData, setCartId, setPhoneNumber]\n  );\n\n  const getAllSlotsByDateTime = useCallback(() => {\n    const groundList = [];\n\n    if (isGroundSelected1) {\n      groundList.push(\"turf01\");\n    }\n    if (isGroundSelected2) {\n      groundList.push(\"turf02\");\n    }\n    if (isGroundSelected3) {\n      groundList.push(\"turf03\");\n    }\n    const postData = {\n      turfIds: [...groundList],\n      date: bookDate,\n      openTime: \"2020-12-24T08:00:00.000Z\",\n      closeTime: \"2020-12-24T16:00:10.000Z\",\n      slotDuration: 30,\n    };\n    axios\n      .post(api + \"user/get-all-slots-by-date\", postData, headerWithoutToken)\n      .then((res) => {\n        const groundDataNew = res.data.body;\n        console.log(\"Get All Slots by Date \", groundDataNew);\n        if (groundDataNew) {\n          if (groundDataNew.turf01) {\n            groundDataNew.turf01.forEach((item) => {\n              item.id = `${item.startTime}_g1_${item.date}`;\n            });\n          }\n\n          if (groundDataNew.turf02) {\n            groundDataNew.turf02.forEach((item) => {\n              item.id = `${item.startTime}_g2_${item.date}`;\n            });\n          }\n\n          if (groundDataNew.turf03) {\n            groundDataNew.turf03.forEach((item) => {\n              item.id = `${item.startTime}_g3_${item.date}`;\n            });\n          }\n\n          fetchCartData(groundDataNew);\n        } else {\n          toast.error(\"No Slots Found\");\n        }\n      })\n      .catch((error) => {\n        toast.error(error.message);\n        console.log(error.message);\n      });\n  }, [\n    isGroundSelected1,\n    isGroundSelected2,\n    isGroundSelected3,\n    bookDate,\n    fetchCartData,\n  ]);\n\n  const setUserData = useCallback(() => {\n    const turfcartId = localStorage.getItem(\"turfCart\");\n    const data = JSON.parse(localStorage.getItem(\"turfUserDetails\"));\n\n    setCartId(() => (turfcartId ? turfcartId : null));\n    setPhoneNumber(() =>\n      data?.user?.phoneNumber ? data?.user?.phoneNumber : null\n    );\n  }, [setCartId, setPhoneNumber]);\n\n  useEffect(() => {\n    getMaxAllowedMonth(setMaxAllowedDate);\n    setUserData();\n    getAllSlotsByDateTime();\n  }, [getAllSlotsByDateTime, setUserData]);\n\n  return (\n    <div className={classnames(\"container is-fluid\")}>\n      <div className={classnames(\"columns\", styles.columnsWrapper)}>\n        <div className={classnames(\"column box\", styles.addGroundBackground)}>\n          <figure\n            className={classnames(\"image\", styles.rotate1)}\n            onClick={() => {\n              setIsGroundSelected1(!isGroundSelected1);\n            }}\n          >\n            {isGroundSelected1 ? (\n              <img\n                src={GroundImageSelected}\n                alt=\"Ground 1\"\n                className={styles.GroundImage}\n              />\n            ) : (\n              <img\n                src={GroundImage}\n                alt=\"Ground 1\"\n                className={styles.GroundImage}\n              />\n            )}\n          </figure>\n\n          <figure\n            className={classnames(\"image\", styles.rotate)}\n            onClick={() => {\n              setIsGroundSelected2(!isGroundSelected2);\n            }}\n          >\n            {isGroundSelected2 ? (\n              <img\n                src={GroundImageSelected}\n                alt=\"Ground 2\"\n                className={styles.GroundImage}\n              />\n            ) : (\n              <img\n                src={GroundImage}\n                alt=\"Ground 2\"\n                className={styles.GroundImage}\n              />\n            )}\n          </figure>\n\n          <figure\n            className={classnames(\"image\", styles.rotate)}\n            onClick={() => {\n              setIsGroundSelected3(!isGroundSelected3);\n            }}\n          >\n            {isGroundSelected3 ? (\n              <img\n                src={GroundImageSelected}\n                alt=\"Ground 3\"\n                className={styles.GroundImage}\n              />\n            ) : (\n              <img\n                src={GroundImage}\n                alt=\"Ground 3\"\n                className={styles.GroundImage}\n              />\n            )}\n          </figure>\n        </div>\n\n        <div\n          className={classnames(\n            \"column box is-two-thirds\",\n            styles.addMinHeight,\n            styles.addBookingBackground\n          )}\n        >\n          <div className={classnames(styles.timeBarWrapper)}>\n            <div style={{ display: \"flex\" }} className={styles.dateWrapper}>\n              <BiCalendarWeek size={40} color=\"#FFF\" className=\"mx-3\" />\n              <div className=\"control has-icons-right\">\n                <input\n                  className=\"input\"\n                  type=\"date\"\n                  placeholder=\"Pick Date\"\n                  value={bookDate}\n                  min={new Date().toISOString().slice(0, 10)}\n                  max={maxAllowedDate}\n                  onChange={(event) => {\n                    setBookDate(event.target.value);\n                  }}\n                />\n                <span className=\"icon is-small is-right\">\n                  <BiCalendarWeek color=\"#000\" />\n                </span>\n              </div>\n            </div>\n\n            <div style={{ display: \"flex\" }}>\n              <BiCalendarWeek size={40} color=\"#FFF\" className=\"mx-3\" />\n              <div className=\"control\">\n                <input\n                  className=\"input \"\n                  type=\"time\"\n                  placeholder=\"Pick Start Time\"\n                  value={startTime}\n                  onChange={(event) => setStartTime(event.target.value)}\n                />\n              </div>\n              <div className=\"control\">\n                <input\n                  className=\"input ml-3\"\n                  type=\"time\"\n                  placeholder=\"Pick End Time\"\n                  value={endTime}\n                  onChange={(event) => setEndTime(event.target.value)}\n                />\n              </div>\n            </div>\n          </div>\n          <div className={classnames(styles.slotsWrapper)}>\n            <SlotItems />\n          </div>\n          <div className={classnames(styles.checkoutWrapper, \"my-3\")}>\n            <div className={styles.timeBarWrapper}>\n              <div style={{ display: \"flex\" }} className={styles.dateWrapper , \"is-hidden-touch\"}>\n                <div className=\"field\">\n                  <div className=\"control\">\n                    <input\n                      className={classnames(styles.hourcal, \"input is-size-4-mobile is-size-3\")}\n                      type=\"text\"\n                      placeholder=\"Total Hours\"\n                      readOnly\n                      value={convertMinsToHrsMins(totalTime)}\n                    />\n                  </div>\n                </div>\n              </div>\n\n              <Link\n                to=\"/cart\"\n                className={classnames(\n                  styles.checkoutbtn,\n                  \"button is-success is-light my-3 is-size-4-mobile is-size-3\"\n                )}\n              >\n                Checkout\n              </Link>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Bookings;\n"]},"metadata":{},"sourceType":"module"}