{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _regeneratorRuntime from\"/var/www/turf2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/var/www/turf2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/var/www/turf2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useCallback,useEffect,useState,useContext,useRef}from\"react\";import classnames from\"classnames\";import{Context}from\"../data/context\";import styles from\"../css/Profile.module.css\";import{toast}from\"react-toastify\";import axios from\"axios\";import api from\"../config/api\";import headerWithToken from\"../config/headerWithToken\";import BookingSummary from\"../components/BookingSummary\";var Profile=function Profile(){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),userData=_useState2[0],setUserData=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isModalOpen=_useState4[0],setisModalOpen=_useState4[1];var _useContext=useContext(Context),setIsLoggedIn=_useContext.setIsLoggedIn;var nameRef=useRef(null);var emailRef=useRef(null);var DOBRef=useRef(null);var fetchUserData=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return JSON.parse(localStorage.getItem(\"turfUserDetails\"));case 2:data=_context.sent;setUserData(data.user);case 4:case\"end\":return _context.stop();}}},_callee);})),[]);var handleSaveProfileChanges=function handleSaveProfileChanges(){if(!nameRef.current.value.trim().length){toast.error(\"Name Cannot be empty\");return;}if(!emailRef.current.value.trim().length){toast.error(\"Email Cannot be empty\");return;}if(!DOBRef.current.value.trim().length){toast.error(\"Date of Birth Cannot be empty\");return;}var data={name:nameRef.current.value,emailId:emailRef.current.value,dateOfBirth:DOBRef.current.value,phoneNumber:userData.phoneNumber};axios.put(api+\"user/update-profile/\",data,headerWithToken).then(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(res){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!res.data.success){_context2.next=8;break;}toast(\"Profile Changes saved successfully\");_context2.next=4;return localStorage.removeItem(\"turfUserDetails\");case 4:_context2.next=6;return localStorage.setItem(\"turfUserDetails\",JSON.stringify({user:res.data.body}));case 6:setUserData(res.data.body);setisModalOpen(false);case 8:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x){return _ref2.apply(this,arguments);};}()).catch(function(err){console.log(err.message);toast.error(err.message);});};useEffect(function(){fetchUserData();},[fetchUserData]);return/*#__PURE__*/_jsx(\"div\",{className:classnames(\"section\",styles.ProfileWrapper),children:/*#__PURE__*/_jsxs(\"div\",{className:classnames(\"container is-fluid\",styles.overRideContainer),children:[/*#__PURE__*/_jsxs(\"div\",{className:classnames(\" columns mt-5\"),children:[/*#__PURE__*/_jsxs(\"div\",{className:classnames(\"column box has-text-centered\",styles.ProfileLeftColumn),children:[/*#__PURE__*/_jsx(\"figure\",{className:classnames(styles.ProfileImageWrapper,\"my-5\"),children:/*#__PURE__*/_jsx(\"img\",{src:\"https://placeimg.com/640/480/any\",alt:\"Profile \"})}),/*#__PURE__*/_jsx(\"p\",{className:classnames(\"subtitle is-2 is-uppercase has-text-white\"),children:userData===null||userData===void 0?void 0:userData.name}),/*#__PURE__*/_jsx(\"p\",{className:classnames(\"subtitle is-4  has-text-white\"),children:userData===null||userData===void 0?void 0:userData.phoneNumber}),/*#__PURE__*/_jsx(\"p\",{className:classnames(\"subtitle is-4  has-text-white\"),children:userData===null||userData===void 0?void 0:userData.emailId}),/*#__PURE__*/_jsxs(\"div\",{className:classnames(\"is-flex-direction-row\"),children:[/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){setisModalOpen(true);},className:\"button is-link mx-3\",children:\"Edit\"}),/*#__PURE__*/_jsx(\"button\",{onClick:/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return localStorage.removeItem(\"turfUserDetails\");case 2:setIsLoggedIn(false);case 3:case\"end\":return _context3.stop();}}},_callee3);})),className:\"button is-danger\",children:\"Logout\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:classnames(\"column is-two-thirds\",styles.SecondColumns),children:/*#__PURE__*/_jsx(BookingSummary,{})})]}),/*#__PURE__*/_jsxs(\"div\",{className:classnames(\"modal\",isModalOpen?\"is-active\":\"\"),children:[/*#__PURE__*/_jsx(\"div\",{className:\"modal-background\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-card\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"modal-card-head\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"modal-card-title\",children:\"Edit Profile\"}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return setisModalOpen(false);},className:\"delete\",\"aria-label\":\"close\"})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"modal-card-body\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"field\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:\"Full Name\"}),/*#__PURE__*/_jsx(\"div\",{className:\"control\",children:/*#__PURE__*/_jsx(\"input\",{ref:nameRef,className:\"input\",type:\"text\",placeholder:\"Eg: Joe Deo\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"field\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{ref:emailRef,className:\"input\",type:\"email\",placeholder:\"Email\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"field\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"label\",children:\"Date Of Birth\"}),/*#__PURE__*/_jsx(\"input\",{ref:DOBRef,className:\"input\",type:\"date\",placeholder:\"Date of Birth\"})]})]}),/*#__PURE__*/_jsx(\"footer\",{className:\"modal-card-foot\",children:/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return handleSaveProfileChanges();},className:\"button is-success\",children:\"Save changes\"})})]})]})]})});};export default Profile;","map":{"version":3,"sources":["/var/www/turf2/src/pages/Profile.jsx"],"names":["React","useCallback","useEffect","useState","useContext","useRef","classnames","Context","styles","toast","axios","api","headerWithToken","BookingSummary","Profile","userData","setUserData","isModalOpen","setisModalOpen","setIsLoggedIn","nameRef","emailRef","DOBRef","fetchUserData","JSON","parse","localStorage","getItem","data","user","handleSaveProfileChanges","current","value","trim","length","error","name","emailId","dateOfBirth","phoneNumber","put","then","res","success","removeItem","setItem","stringify","body","catch","err","console","log","message","ProfileWrapper","overRideContainer","ProfileLeftColumn","ProfileImageWrapper","SecondColumns"],"mappings":"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","sourcesContent":["import React, {\n  useCallback,\n  useEffect,\n  useState,\n  useContext,\n  useRef,\n} from \"react\";\nimport classnames from \"classnames\";\nimport { Context } from \"../data/context\";\nimport styles from \"../css/Profile.module.css\";\nimport { toast } from \"react-toastify\";\nimport axios from \"axios\";\nimport api from \"../config/api\";\nimport headerWithToken from \"../config/headerWithToken\";\nimport BookingSummary from \"../components/BookingSummary\";\n\nconst Profile = () => {\n  const [userData, setUserData] = useState(null);\n  const [isModalOpen, setisModalOpen] = useState(false);\n\n  const { setIsLoggedIn } = useContext(Context);\n\n  const nameRef = useRef(null);\n  const emailRef = useRef(null);\n  const DOBRef = useRef(null);\n\n  const fetchUserData = useCallback(async () => {\n    var data = await JSON.parse(localStorage.getItem(\"turfUserDetails\"));\n    setUserData(data.user);\n  }, []);\n\n  const handleSaveProfileChanges = () => {\n    if (!nameRef.current.value.trim().length) {\n      toast.error(\"Name Cannot be empty\");\n      return;\n    }\n    if (!emailRef.current.value.trim().length) {\n      toast.error(\"Email Cannot be empty\");\n      return;\n    }\n    if (!DOBRef.current.value.trim().length) {\n      toast.error(\"Date of Birth Cannot be empty\");\n      return;\n    }\n\n    const data = {\n      name: nameRef.current.value,\n      emailId: emailRef.current.value,\n      dateOfBirth: DOBRef.current.value,\n      phoneNumber: userData.phoneNumber,\n    };\n\n    axios\n      .put(api + \"user/update-profile/\", data, headerWithToken)\n      .then(async (res) => {\n        if (res.data.success) {\n          toast(\"Profile Changes saved successfully\");\n          await localStorage.removeItem(\"turfUserDetails\");\n          await localStorage.setItem(\n            \"turfUserDetails\",\n            JSON.stringify({ user: res.data.body })\n          );\n\n          setUserData(res.data.body);\n          setisModalOpen(false);\n        }\n      })\n      .catch((err) => {\n        console.log(err.message);\n        toast.error(err.message);\n      });\n  };\n\n  useEffect(() => {\n    fetchUserData();\n  }, [fetchUserData]);\n\n  return (\n    <div className={classnames(\"section\", styles.ProfileWrapper)}>\n      <div\n        className={classnames(\"container is-fluid\", styles.overRideContainer)}\n      >\n        <div className={classnames(\" columns mt-5\")}>\n          <div\n            className={classnames(\n              \"column box has-text-centered\",\n              styles.ProfileLeftColumn\n            )}\n          >\n            <figure className={classnames(styles.ProfileImageWrapper, \"my-5\")}>\n              <img src=\"https://placeimg.com/640/480/any\" alt=\"Profile \" />\n            </figure>\n\n            <p\n              className={classnames(\n                \"subtitle is-2 is-uppercase has-text-white\"\n              )}\n            >\n              {userData?.name}\n            </p>\n            <p className={classnames(\"subtitle is-4  has-text-white\")}>\n              {userData?.phoneNumber}\n            </p>\n            <p className={classnames(\"subtitle is-4  has-text-white\")}>\n              {userData?.emailId}\n            </p>\n\n            <div className={classnames(\"is-flex-direction-row\")}>\n              <button\n                onClick={() => {\n                  setisModalOpen(true);\n                }}\n                className=\"button is-link mx-3\"\n              >\n                Edit\n              </button>\n              <button\n                onClick={async () => {\n                  await localStorage.removeItem(\"turfUserDetails\");\n                  setIsLoggedIn(false);\n                }}\n                className=\"button is-danger\"\n              >\n                Logout\n              </button>\n            </div>\n          </div>\n          <div\n            className={classnames(\"column is-two-thirds\", styles.SecondColumns)}\n          >\n            <BookingSummary />\n          </div>\n        </div>\n\n        <div className={classnames(\"modal\", isModalOpen ? \"is-active\" : \"\")}>\n          <div className=\"modal-background\"></div>\n          <div className=\"modal-card\">\n            <header className=\"modal-card-head\">\n              <p className=\"modal-card-title\">Edit Profile</p>\n              <button\n                onClick={() => setisModalOpen(false)}\n                className=\"delete\"\n                aria-label=\"close\"\n              ></button>\n            </header>\n            <section className=\"modal-card-body\">\n              <div className=\"field\">\n                <label className=\"label\">Full Name</label>\n                <div className=\"control\">\n                  <input\n                    ref={nameRef}\n                    className=\"input\"\n                    type=\"text\"\n                    placeholder=\"Eg: Joe Deo\"\n                  />\n                </div>\n              </div>\n\n              <div className=\"field\">\n                <label className=\"label\">Email</label>\n                <input\n                  ref={emailRef}\n                  className=\"input\"\n                  type=\"email\"\n                  placeholder=\"Email\"\n                />\n              </div>\n\n              <div className=\"field\">\n                <label className=\"label\">Date Of Birth</label>\n                <input\n                  ref={DOBRef}\n                  className=\"input\"\n                  type=\"date\"\n                  placeholder=\"Date of Birth\"\n                />\n              </div>\n            </section>\n            <footer className=\"modal-card-foot\">\n              <button\n                onClick={() => handleSaveProfileChanges()}\n                className=\"button is-success\"\n              >\n                Save changes\n              </button>\n            </footer>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Profile;\n"]},"metadata":{},"sourceType":"module"}