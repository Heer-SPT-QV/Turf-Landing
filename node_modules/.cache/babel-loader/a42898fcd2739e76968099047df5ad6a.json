{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/sptdev/Desktop/reactjs/turf2/src/components/Bookings.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useCallback, useContext } from \"react\";\nimport classnames from \"classnames\";\nimport axios from \"axios\";\nimport { BiCalendarWeek } from \"react-icons/bi\";\nimport { toast } from \"react-toastify\";\nimport styles from \"../css/Bookings.module.css\";\nimport GroundImage from \"../images/ground.png\";\nimport GroundImageSelected from \"../images/ground_selected.png\";\nimport api from \"../config/api\";\nimport headerWithoutToken from \"../config/headerWithoutToken\";\nimport { Context } from \"../data/context\";\nimport SlotItems from \"./SlotItems\";\nimport { convertMinsToHrsMins, getMaxAllowedMonth } from \"../utils/TimeConverter\";\nimport { Link } from \"react-router-dom\";\nimport { filterData } from \"../utils/filterData\";\n\nconst Bookings = () => {\n  _s();\n\n  const {\n    setGroundData,\n    totalTime,\n    bookDate,\n    setBookDate,\n    setCartId,\n    setPhoneNumber,\n    setCartData\n  } = useContext(Context);\n  const [isGroundSelected1, setIsGroundSelected1] = useState(true);\n  const [isGroundSelected2, setIsGroundSelected2] = useState(false);\n  const [isGroundSelected3, setIsGroundSelected3] = useState(false);\n  const [maxAllowedDate, setMaxAllowedDate] = useState(\"\");\n  const [startTime, setStartTime] = useState(\"\");\n  const [endTime, setEndTime] = useState(\"\");\n  const handleFetchedData = useCallback(res => {\n    if (res.data.success) {\n      if (res.data.body) {\n        if (res.data.body.selectedSlots.length) {\n          const [sortedData] = filterData(res.data.body);\n          setCartData(sortedData);\n        }\n      }\n    }\n  }, [setCartData]);\n  const fetchCartData = useCallback(() => {\n    const data = JSON.parse(localStorage.getItem(\"turfUserDetails\"));\n    const cartLocalId = localStorage.getItem(\"turfCart\");\n    setCartId(() => cartLocalId ? cartLocalId : null);\n    setPhoneNumber(() => {\n      var _data$user;\n\n      return (data === null || data === void 0 ? void 0 : (_data$user = data.user) === null || _data$user === void 0 ? void 0 : _data$user.phoneNumber) ? data.user.phoneNumber : null;\n    }); // if (data === null && cartLocalId === null) {\n    //   setCartId(null);\n    // } else if (data === null && cartLocalId != null) {\n    //   setCartId(cartLocalId);\n    // } else {\n    //   setPhoneNumber(data.user.phoneNumber);\n    // }\n\n    if (data === null) {\n      axios.get(api + \"user/cart?cartId=\" + cartLocalId, headerWithoutToken).then(res => {\n        handleFetchedData(res);\n      }).catch(err => {\n        console.log(err);\n      });\n    } else {\n      axios.get(api + \"user/cart?phoneNumber=\" + data.user.phoneNumber, headerWithoutToken).then(res => {\n        handleFetchedData(res);\n      }).catch(err => {\n        console.log(err);\n      });\n    }\n  }, [handleFetchedData, setCartId, setPhoneNumber]);\n  const markSelectedCard = useCallback(groundDataNew => {\n    if (groundDataNew.turf01) {\n      groundDataNew.turf01.forEach(item => {\n        item.id = `${item.startTime}_g1_${item.date}`;\n      });\n    }\n\n    if (groundDataNew.turf02) {\n      groundDataNew.turf02.forEach(item => {\n        item.id = `${item.startTime}_g2_${item.date}`;\n      });\n    }\n\n    if (groundDataNew.turf03) {\n      groundDataNew.turf03.forEach(item => {\n        item.id = `${item.startTime}_g3_${item.date}`;\n      });\n    }\n\n    setGroundData(groundDataNew);\n  }, [setGroundData]);\n  const getAllSlotsByDateTime = useCallback(() => {\n    const groundList = [];\n\n    if (isGroundSelected1) {\n      groundList.push(\"turf01\");\n    }\n\n    if (isGroundSelected2) {\n      groundList.push(\"turf02\");\n    }\n\n    if (isGroundSelected3) {\n      groundList.push(\"turf03\");\n    }\n\n    const postData = {\n      turfIds: [...groundList],\n      date: bookDate,\n      openTime: \"2020-12-24T08:00:00.000Z\",\n      closeTime: \"2020-12-24T16:00:10.000Z\",\n      slotDuration: 30\n    };\n    axios.post(api + \"user/get-all-slots-by-date\", postData, headerWithoutToken).then(res => {\n      const responseData = res.data.body;\n      console.log(\"Get All Slots by Date \", responseData);\n\n      if (responseData) {\n        markSelectedCard(responseData);\n      } else {\n        toast.error(\"Something went wrong\");\n      }\n    }).catch(error => {\n      toast.error(error.message);\n      console.log(error.message);\n    });\n  }, [isGroundSelected1, isGroundSelected2, isGroundSelected3, bookDate, markSelectedCard]);\n  const setUserData = useCallback(() => {\n    const turfcartId = localStorage.getItem(\"turfCart\");\n    const data = JSON.parse(localStorage.getItem(\"turfUserDetails\"));\n    setCartId(() => turfcartId ? turfcartId : null);\n    setPhoneNumber(() => {\n      var _data$user2, _data$user3;\n\n      return (data === null || data === void 0 ? void 0 : (_data$user2 = data.user) === null || _data$user2 === void 0 ? void 0 : _data$user2.phoneNumber) ? data === null || data === void 0 ? void 0 : (_data$user3 = data.user) === null || _data$user3 === void 0 ? void 0 : _data$user3.phoneNumber : null;\n    });\n  }, [setCartId, setPhoneNumber]);\n  useEffect(() => {\n    getMaxAllowedMonth(setMaxAllowedDate);\n    setUserData();\n    getAllSlotsByDateTime();\n    fetchCartData();\n  }, [getAllSlotsByDateTime, fetchCartData, setUserData]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: classnames(\"container is-fluid\"),\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: classnames(\"columns\", styles.columnsWrapper),\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: classnames(\"column box\", styles.addGroundBackground),\n        children: [/*#__PURE__*/_jsxDEV(\"figure\", {\n          className: \"image\",\n          onClick: () => {\n            setIsGroundSelected1(!isGroundSelected1);\n          },\n          children: isGroundSelected1 ? /*#__PURE__*/_jsxDEV(\"img\", {\n            src: GroundImageSelected,\n            alt: \"Ground 1\",\n            className: styles.GroundImage\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 187,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(\"img\", {\n            src: GroundImage,\n            alt: \"Ground 1\",\n            className: styles.GroundImage\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 193,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 180,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"figure\", {\n          className: \"image\",\n          onClick: () => {\n            setIsGroundSelected2(!isGroundSelected2);\n          },\n          children: isGroundSelected2 ? /*#__PURE__*/_jsxDEV(\"img\", {\n            src: GroundImageSelected,\n            alt: \"Ground 2\",\n            className: styles.GroundImage\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 208,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(\"img\", {\n            src: GroundImage,\n            alt: \"Ground 2\",\n            className: styles.GroundImage\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 214,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 201,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"figure\", {\n          className: \"image\",\n          onClick: () => {\n            setIsGroundSelected3(!isGroundSelected3);\n          },\n          children: isGroundSelected3 ? /*#__PURE__*/_jsxDEV(\"img\", {\n            src: GroundImageSelected,\n            alt: \"Ground 3\",\n            className: styles.GroundImage\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 229,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(\"img\", {\n            src: GroundImage,\n            alt: \"Ground 3\",\n            className: styles.GroundImage\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 235,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 222,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: classnames(\"column box is-two-thirds\", styles.addMinHeight, styles.addBookingBackground),\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: classnames(styles.timeBarWrapper),\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              display: \"flex\"\n            },\n            className: styles.dateWrapper,\n            children: [/*#__PURE__*/_jsxDEV(BiCalendarWeek, {\n              size: 40,\n              color: \"#FFF\",\n              className: \"mx-3\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 253,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"control has-icons-right\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                className: \"input\",\n                type: \"date\",\n                placeholder: \"Pick Date\",\n                value: bookDate,\n                min: new Date().toISOString().slice(0, 10),\n                max: maxAllowedDate,\n                onChange: event => {\n                  setBookDate(event.target.value);\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 255,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"icon is-small is-right\",\n                children: /*#__PURE__*/_jsxDEV(BiCalendarWeek, {\n                  color: \"#000\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 267,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 266,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 254,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 252,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              display: \"flex\"\n            },\n            children: [/*#__PURE__*/_jsxDEV(BiCalendarWeek, {\n              size: 40,\n              color: \"#FFF\",\n              className: \"mx-3\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 273,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"control\",\n              children: /*#__PURE__*/_jsxDEV(\"input\", {\n                className: \"input \",\n                type: \"time\",\n                placeholder: \"Pick Start Time\",\n                value: startTime,\n                onChange: event => setStartTime(event.target.value)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 275,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 274,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"control\",\n              children: /*#__PURE__*/_jsxDEV(\"input\", {\n                className: \"input ml-3\",\n                type: \"time\",\n                placeholder: \"Pick End Time\",\n                value: endTime,\n                onChange: event => setEndTime(event.target.value)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 284,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 283,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 272,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 251,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: classnames(styles.slotsWrapper),\n          children: /*#__PURE__*/_jsxDEV(SlotItems, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 295,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 294,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: classnames(styles.checkoutWrapper, \"my-3\"),\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: styles.timeBarWrapper,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                display: \"flex\"\n              },\n              className: styles.dateWrapper,\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"field\",\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"control\",\n                  children: /*#__PURE__*/_jsxDEV(\"input\", {\n                    className: \"input\",\n                    type: \"text\",\n                    placeholder: \"Total Hours\",\n                    readOnly: true,\n                    value: convertMinsToHrsMins(totalTime)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 302,\n                    columnNumber: 21\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 301,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 300,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 299,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Link, {\n              to: \"/cart\",\n              className: \"button is-success is-light my-3\",\n              children: \"Checkout\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 313,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 298,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 297,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 244,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 177,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Bookings, \"1cxK1tDppUjzKuDpwH3wsG1vAvk=\");\n\n_c = Bookings;\nexport default Bookings;\n\nvar _c;\n\n$RefreshReg$(_c, \"Bookings\");","map":{"version":3,"sources":["/Users/sptdev/Desktop/reactjs/turf2/src/components/Bookings.jsx"],"names":["React","useState","useEffect","useCallback","useContext","classnames","axios","BiCalendarWeek","toast","styles","GroundImage","GroundImageSelected","api","headerWithoutToken","Context","SlotItems","convertMinsToHrsMins","getMaxAllowedMonth","Link","filterData","Bookings","setGroundData","totalTime","bookDate","setBookDate","setCartId","setPhoneNumber","setCartData","isGroundSelected1","setIsGroundSelected1","isGroundSelected2","setIsGroundSelected2","isGroundSelected3","setIsGroundSelected3","maxAllowedDate","setMaxAllowedDate","startTime","setStartTime","endTime","setEndTime","handleFetchedData","res","data","success","body","selectedSlots","length","sortedData","fetchCartData","JSON","parse","localStorage","getItem","cartLocalId","user","phoneNumber","get","then","catch","err","console","log","markSelectedCard","groundDataNew","turf01","forEach","item","id","date","turf02","turf03","getAllSlotsByDateTime","groundList","push","postData","turfIds","openTime","closeTime","slotDuration","post","responseData","error","message","setUserData","turfcartId","columnsWrapper","addGroundBackground","addMinHeight","addBookingBackground","timeBarWrapper","display","dateWrapper","Date","toISOString","slice","event","target","value","slotsWrapper","checkoutWrapper"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useCallback, useContext } from \"react\";\nimport classnames from \"classnames\";\nimport axios from \"axios\";\nimport { BiCalendarWeek } from \"react-icons/bi\";\nimport { toast } from \"react-toastify\";\nimport styles from \"../css/Bookings.module.css\";\nimport GroundImage from \"../images/ground.png\";\nimport GroundImageSelected from \"../images/ground_selected.png\";\nimport api from \"../config/api\";\nimport headerWithoutToken from \"../config/headerWithoutToken\";\nimport { Context } from \"../data/context\";\nimport SlotItems from \"./SlotItems\";\nimport {\n  convertMinsToHrsMins,\n  getMaxAllowedMonth,\n} from \"../utils/TimeConverter\";\nimport { Link } from \"react-router-dom\";\nimport { filterData } from \"../utils/filterData\";\n\nconst Bookings = () => {\n  const {\n    setGroundData,\n    totalTime,\n    bookDate,\n    setBookDate,\n    setCartId,\n    setPhoneNumber,\n    setCartData,\n  } = useContext(Context);\n\n  const [isGroundSelected1, setIsGroundSelected1] = useState(true);\n  const [isGroundSelected2, setIsGroundSelected2] = useState(false);\n  const [isGroundSelected3, setIsGroundSelected3] = useState(false);\n  const [maxAllowedDate, setMaxAllowedDate] = useState(\"\");\n  const [startTime, setStartTime] = useState(\"\");\n  const [endTime, setEndTime] = useState(\"\");\n\n  const handleFetchedData = useCallback(\n    (res) => {\n      if (res.data.success) {\n        if (res.data.body) {\n          if (res.data.body.selectedSlots.length) {\n            const [sortedData] = filterData(res.data.body);\n            setCartData(sortedData);\n          }\n        }\n      }\n    },\n    [setCartData]\n  );\n\n  const fetchCartData = useCallback(() => {\n    const data = JSON.parse(localStorage.getItem(\"turfUserDetails\"));\n    const cartLocalId = localStorage.getItem(\"turfCart\");\n\n    setCartId(() => (cartLocalId ? cartLocalId : null));\n\n    setPhoneNumber(() =>\n      data?.user?.phoneNumber ? data.user.phoneNumber : null\n    );\n\n    // if (data === null && cartLocalId === null) {\n    //   setCartId(null);\n    // } else if (data === null && cartLocalId != null) {\n    //   setCartId(cartLocalId);\n    // } else {\n    //   setPhoneNumber(data.user.phoneNumber);\n    // }\n\n    if (data === null) {\n      axios\n        .get(api + \"user/cart?cartId=\" + cartLocalId, headerWithoutToken)\n        .then((res) => {\n          handleFetchedData(res);\n        })\n        .catch((err) => {\n          console.log(err);\n        });\n    } else {\n      axios\n        .get(\n          api + \"user/cart?phoneNumber=\" + data.user.phoneNumber,\n          headerWithoutToken\n        )\n        .then((res) => {\n          handleFetchedData(res);\n        })\n        .catch((err) => {\n          console.log(err);\n        });\n    }\n  }, [handleFetchedData, setCartId, setPhoneNumber]);\n\n  const markSelectedCard = useCallback(\n    (groundDataNew) => {\n      if (groundDataNew.turf01) {\n        groundDataNew.turf01.forEach((item) => {\n          item.id = `${item.startTime}_g1_${item.date}`;\n        });\n      }\n      if (groundDataNew.turf02) {\n        groundDataNew.turf02.forEach((item) => {\n          item.id = `${item.startTime}_g2_${item.date}`;\n        });\n      }\n      if (groundDataNew.turf03) {\n        groundDataNew.turf03.forEach((item) => {\n          item.id = `${item.startTime}_g3_${item.date}`;\n        });\n      }\n\n      setGroundData(groundDataNew);\n    },\n    [setGroundData]\n  );\n\n  const getAllSlotsByDateTime = useCallback(() => {\n    const groundList = [];\n\n    if (isGroundSelected1) {\n      groundList.push(\"turf01\");\n    }\n    if (isGroundSelected2) {\n      groundList.push(\"turf02\");\n    }\n    if (isGroundSelected3) {\n      groundList.push(\"turf03\");\n    }\n    const postData = {\n      turfIds: [...groundList],\n      date: bookDate,\n      openTime: \"2020-12-24T08:00:00.000Z\",\n      closeTime: \"2020-12-24T16:00:10.000Z\",\n      slotDuration: 30,\n    };\n    axios\n      .post(api + \"user/get-all-slots-by-date\", postData, headerWithoutToken)\n      .then((res) => {\n        const responseData = res.data.body;\n        console.log(\"Get All Slots by Date \", responseData);\n        if (responseData) {\n          markSelectedCard(responseData);\n        } else {\n          toast.error(\"Something went wrong\");\n        }\n      })\n      .catch((error) => {\n        toast.error(error.message);\n        console.log(error.message);\n      });\n  }, [\n    isGroundSelected1,\n    isGroundSelected2,\n    isGroundSelected3,\n    bookDate,\n    markSelectedCard,\n  ]);\n\n  const setUserData = useCallback(() => {\n    const turfcartId = localStorage.getItem(\"turfCart\");\n    const data = JSON.parse(localStorage.getItem(\"turfUserDetails\"));\n\n    setCartId(() => (turfcartId ? turfcartId : null));\n    setPhoneNumber(() =>\n      data?.user?.phoneNumber ? data?.user?.phoneNumber : null\n    );\n  }, [setCartId, setPhoneNumber]);\n\n  useEffect(() => {\n    getMaxAllowedMonth(setMaxAllowedDate);\n    setUserData();\n    getAllSlotsByDateTime();\n    fetchCartData();\n  }, [getAllSlotsByDateTime, fetchCartData, setUserData]);\n\n  return (\n    <div className={classnames(\"container is-fluid\")}>\n      <div className={classnames(\"columns\", styles.columnsWrapper)}>\n        <div className={classnames(\"column box\", styles.addGroundBackground)}>\n          <figure\n            className=\"image\"\n            onClick={() => {\n              setIsGroundSelected1(!isGroundSelected1);\n            }}\n          >\n            {isGroundSelected1 ? (\n              <img\n                src={GroundImageSelected}\n                alt=\"Ground 1\"\n                className={styles.GroundImage}\n              />\n            ) : (\n              <img\n                src={GroundImage}\n                alt=\"Ground 1\"\n                className={styles.GroundImage}\n              />\n            )}\n          </figure>\n\n          <figure\n            className=\"image\"\n            onClick={() => {\n              setIsGroundSelected2(!isGroundSelected2);\n            }}\n          >\n            {isGroundSelected2 ? (\n              <img\n                src={GroundImageSelected}\n                alt=\"Ground 2\"\n                className={styles.GroundImage}\n              />\n            ) : (\n              <img\n                src={GroundImage}\n                alt=\"Ground 2\"\n                className={styles.GroundImage}\n              />\n            )}\n          </figure>\n\n          <figure\n            className=\"image\"\n            onClick={() => {\n              setIsGroundSelected3(!isGroundSelected3);\n            }}\n          >\n            {isGroundSelected3 ? (\n              <img\n                src={GroundImageSelected}\n                alt=\"Ground 3\"\n                className={styles.GroundImage}\n              />\n            ) : (\n              <img\n                src={GroundImage}\n                alt=\"Ground 3\"\n                className={styles.GroundImage}\n              />\n            )}\n          </figure>\n        </div>\n\n        <div\n          className={classnames(\n            \"column box is-two-thirds\",\n            styles.addMinHeight,\n            styles.addBookingBackground\n          )}\n        >\n          <div className={classnames(styles.timeBarWrapper)}>\n            <div style={{ display: \"flex\" }} className={styles.dateWrapper}>\n              <BiCalendarWeek size={40} color=\"#FFF\" className=\"mx-3\" />\n              <div className=\"control has-icons-right\">\n                <input\n                  className=\"input\"\n                  type=\"date\"\n                  placeholder=\"Pick Date\"\n                  value={bookDate}\n                  min={new Date().toISOString().slice(0, 10)}\n                  max={maxAllowedDate}\n                  onChange={(event) => {\n                    setBookDate(event.target.value);\n                  }}\n                />\n                <span className=\"icon is-small is-right\">\n                  <BiCalendarWeek color=\"#000\" />\n                </span>\n              </div>\n            </div>\n\n            <div style={{ display: \"flex\" }}>\n              <BiCalendarWeek size={40} color=\"#FFF\" className=\"mx-3\" />\n              <div className=\"control\">\n                <input\n                  className=\"input \"\n                  type=\"time\"\n                  placeholder=\"Pick Start Time\"\n                  value={startTime}\n                  onChange={(event) => setStartTime(event.target.value)}\n                />\n              </div>\n              <div className=\"control\">\n                <input\n                  className=\"input ml-3\"\n                  type=\"time\"\n                  placeholder=\"Pick End Time\"\n                  value={endTime}\n                  onChange={(event) => setEndTime(event.target.value)}\n                />\n              </div>\n            </div>\n          </div>\n          <div className={classnames(styles.slotsWrapper)}>\n            <SlotItems />\n          </div>\n          <div className={classnames(styles.checkoutWrapper, \"my-3\")}>\n            <div className={styles.timeBarWrapper}>\n              <div style={{ display: \"flex\" }} className={styles.dateWrapper}>\n                <div className=\"field\">\n                  <div className=\"control\">\n                    <input\n                      className=\"input\"\n                      type=\"text\"\n                      placeholder=\"Total Hours\"\n                      readOnly\n                      value={convertMinsToHrsMins(totalTime)}\n                    />\n                  </div>\n                </div>\n              </div>\n\n              <Link to=\"/cart\" className=\"button is-success is-light my-3\">\n                Checkout\n              </Link>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Bookings;\n"]},"metadata":{},"sourceType":"module"}